# 从ULR输入到页面展现到底发生了什么？
## Step 1: 输入 URL
### URL 是什么？
URL是统一资源定位符，用于定位互联网上的资源。
对应的协议包括：
- http 网络资源协议（明文）
- https 因为加了一层隧道，是加密后的协议，所以是安全的http协议。
- file 用于定位本地电脑的文件
- ftp  是文件传输协议，用于控制文件的双向传输。

## Step 2: 域名解析
输入URL之后，浏览器并不知道ULR是什么，需要查找URL所在服务器的IP地址，才能找到相应目标

### 为什么要用域名，不直接用IP?
因为域名具有语义化特征，比较好记。

### 域名解析过程
1. 先从浏览器中读取缓存——浏览器会缓存DNS记录一段时间
2. 如果在浏览器中找不到缓存，则在系统缓存中寻找
使用场景：当开发一个网站，可以在HOST中把URL 匹配给本地IP：127.0.0.1，请求资源转向本地文件，可以节省资源，快速访问。
![2017-04-29 11 28 37](https://cloud.githubusercontent.com/assets/14901221/25552946/7f38707a-2cd9-11e7-886f-baefc4ada36a.png)

3. 如果系统缓存也没有的话，就从路由器缓存中查找
4. ISP DNS缓存——也就是服务提供商那儿查找DNS缓存，比如电信的DNS
5. 如果以上都没有找到DNS缓存，那么则向根域名（com）服务器查找对于IP。根域名的服务器把request转发到下一级，直到找到对于IP。

### IP地址是什么
- 每一个联网的设备都必须要有一个IP
- 局域网IP和公网IP有差别
> 局域网IP 实践场景：当我们开发一个手机界面，但还没上线，在电脑上OK，如何调试手机端呢？
可以把手机和电脑连上同一个WiFi，然后用手机访问PC端服务器IP地址，进行浏览。
- 本机IP：127.0.0.1

> 直接把dns 导向8.8.8.8(google DNS服务器)，不经过中间环节，直接从服务器访问，防止恶意攻击和DNS劫持

## Step 3: 服务器处理
接收、处理用户请求，交给网站代码或反向代理到其他的网络服务器
服务器：一台安装了系统的机器，常见系统有：Linux,Windows Server 2012
系统中安装的处理请求的应用叫作网络服务器，用于接受处理请求
常见的网络服务器有：
- Apache
- Nginx
- IIS
- Lighttpd


## Step 4:网站处理流程
通过 MVC 模型调用处理数据，最终将得到的数据填充到视图中。
![2017-04-29 11 43 49](https://cloud.githubusercontent.com/assets/14901221/25553013/11947bb6-2cdb-11e7-91bd-afbf7f06a4a9.png)
Rails 路由器用于识别网站，分配给对应的控制器进行操作处理。


model 就是调用数据库，给控制器提供接口，通过语言的方式调用得到对应数据，最终把数据填充到视图中。

## Step 5: 浏览器处理
从服务器发来的数据是html字符串，浏览器一句一句读取和解析
当解析到`link`标签时，重新发送请求获取css
当解析到`script`标签时，发送请求获取JS，执行代码
当解析到`img`标签，发送请求获取图片资源

## Step 6:绘制网页
浏览器根据html和css计算得到渲染树，在屏幕上绘制“一幅画”，JS会被执行。
在这幅画中，CSS控制样式
html控制内容

